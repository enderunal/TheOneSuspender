<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Immediate theme injection - MUST be first -->
    <script src="src/common/theme-injector.js"></script>

    <link rel="stylesheet" href="styles/material-colors.css">
    <link rel="stylesheet" href="styles/material-components.css">
    <link rel="stylesheet" href="styles/options-material.css">
    <title>The One Suspender Settings</title>
</head>

<body class="md-surface">
    <div class="md-container options-container">
        <!-- Header -->
        <header class="options-header">
            <h1 class="md-typescale-headline-medium">The One Suspender – Settings</h1>
        </header>

        <!-- Navigation Tabs -->
        <div class="tab-navigation">
            <button type="button" class="tab-button active" data-tab="settings">Settings</button>
            <button type="button" class="tab-button" data-tab="appearance">Appearance</button>
            <button type="button" class="tab-button" data-tab="sessions">Sessions</button>
            <button type="button" class="tab-button" data-tab="tools">Tools</button>
            <button type="button" class="tab-button" data-tab="about">About</button>
        </div>

        <form id="settings-form">
            <!-- Settings Tab -->
            <div class="tab-content active" id="tab-settings">
                <!-- Automatic Suspension Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Automatic Suspension</h2>

                    <div class="md-checkbox">
                        <input type="checkbox" id="autoSuspendEnabled" name="autoSuspendEnabled" checked>
                        <label for="autoSuspendEnabled" class="md-typescale-body-medium">
                            Enable automatic tab suspension
                        </label>
                    </div>

                    <div class="md-text-field">
                        <input type="number" id="inactivityMinutes" name="inactivityMinutes" min="1" step="1" required>
                        <label for="inactivityMinutes">Suspend tabs after (minutes)</label>
                    </div>
                    <p class="md-typescale-body-small field-description">
                        Inactive time before a tab is suspended (Minimum 1 min).
                    </p>
                </div>

                <!-- Exclusions Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Exclusions (Never Suspend)</h2>

                    <div class="checkbox-group">
                        <div class="md-checkbox">
                            <input type="checkbox" id="neverSuspendPinned" name="neverSuspendPinned">
                            <label for="neverSuspendPinned" class="md-typescale-body-medium">Pinned Tabs</label>
                        </div>
                        <div class="md-checkbox">
                            <input type="checkbox" id="neverSuspendAudio" name="neverSuspendAudio">
                            <label for="neverSuspendAudio" class="md-typescale-body-medium">Tabs Playing Audio</label>
                        </div>
                        <div class="md-checkbox">
                            <input type="checkbox" id="neverSuspendActive" name="neverSuspendActive">
                            <label for="neverSuspendActive" class="md-typescale-body-medium">Never Suspend The Active
                                Tab in Each Window</label>
                        </div>
                        <div class="md-checkbox">
                            <input type="checkbox" id="neverSuspendLastWindow" name="neverSuspendLastWindow">
                            <label for="neverSuspendLastWindow" class="md-typescale-body-medium">Never Suspend The
                                Active Tab Only in the Last-Focused Window</label>
                        </div>
                        <div class="md-checkbox">
                            <input type="checkbox" id="neverSuspendOffline" name="neverSuspendOffline">
                            <label for="neverSuspendOffline" class="md-typescale-body-medium">When Browser Is
                                Offline</label>
                        </div>
                    </div>
                </div>

                <!-- Form Handling Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Unsaved Form Handling</h2>
                    <p class="md-typescale-body-medium section-description">How to handle tabs with unsaved form input:
                    </p>

                    <div class="radio-group">
                        <div class="md-radio">
                            <input type="radio" id="unsavedNormal" name="unsavedFormHandling" value="normal" checked>
                            <label for="unsavedNormal" class="md-typescale-body-medium">
                                Suspend Normally (potential data loss)
                            </label>
                        </div>
                        <div class="md-radio">
                            <input type="radio" id="unsavedNever" name="unsavedFormHandling" value="never">
                            <label for="unsavedNever" class="md-typescale-body-medium">
                                Never Suspend
                            </label>
                        </div>
                        <div class="md-radio">
                            <input type="radio" id="unsavedAsk" name="unsavedFormHandling" value="ask">
                            <label for="unsavedAsk" class="md-typescale-body-medium">
                                Ask Before Suspending (using a dialog)
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Whitelist Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">URL Whitelist</h2>
                    <div class="md-text-field">
                        <textarea id="whitelist" name="whitelist" rows="8"></textarea>
                        <label for="whitelist">Never suspend URLs matching</label>
                    </div>
                    <p class="md-typescale-body-small field-description">
                        One URL or domain per line. E.g., google.com or https://mail.google.com/<br>
                        Matches either full URLs or domains (`example.com` matches `www.example.com`).
                    </p>
                </div>

                <!-- Advanced Settings Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Advanced Settings</h2>
                    <h3 class="md-typescale-title-medium subsection-title">Suspension Mode:</h3>

                    <div class="md-checkbox advanced-checkbox">
                        <input type="checkbox" id="preserveHistory" name="preserveHistory">
                        <label for="preserveHistory" class="md-typescale-body-medium">
                            Preserve page history when suspending
                            <span class="tooltip-container">
                                <button type="button" class="tooltip-trigger md-button text compact" tabindex="0"
                                    aria-label="More information">
                                    Help
                                </button>
                                <div class="tooltip-content md-card elevated">
                                    <strong>Preserve History (default):</strong>
                                    Uses regular suspension, keeping tab history and state.
                                    <br><br>
                                    <strong>Close & Reopen:</strong>
                                    Experimental! Might free more RAM when preserve history does not help but
                                    loses tab history. Might consume more CPU.
                                </div>
                            </span>
                        </label>
                    </div>

                    <h3 class="md-typescale-title-medium subsection-title">Developer Options:</h3>

                    <div class="md-checkbox advanced-checkbox">
                        <input type="checkbox" id="enableStandardLogs" name="enableStandardLogs">
                        <label for="enableStandardLogs" class="md-typescale-body-medium">
                            Enable Standard Logs (Info)
                        </label>
                    </div>

                    <div class="md-checkbox advanced-checkbox">
                        <input type="checkbox" id="enableDetailedLogs" name="enableDetailedLogs">
                        <label for="enableDetailedLogs" class="md-typescale-body-medium">
                            Enable Detailed Logs (Debug)
                        </label>
                    </div>

                    <div class="md-checkbox advanced-checkbox">
                        <input type="checkbox" id="enableWarningLogs" name="enableWarningLogs">
                        <label for="enableWarningLogs" class="md-typescale-body-medium">
                            Enable Warning Logs
                        </label>
                    </div>

                    <div class="md-checkbox advanced-checkbox">
                        <input type="checkbox" id="enableErrorLogs" name="enableErrorLogs">
                        <label for="enableErrorLogs" class="md-typescale-body-medium">
                            Enable Error Logs
                        </label>
                    </div>
                </div>

                <!-- Session Management Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Session Management</h2>
                    <p class="md-typescale-body-medium section-description">
                        Configure how browser sessions are automatically saved and managed.
                    </p>

                    <div class="md-text-field">
                        <input type="number" id="sessionMaxSessions" name="sessionMaxSessions" min="1" max="200"
                            value="50" required>
                        <label for="sessionMaxSessions">Maximum Sessions to Keep</label>
                    </div>
                    <p class="md-typescale-body-small field-description">
                        When this limit is reached, the oldest sessions are automatically removed (1-200 sessions).
                    </p>

                    <div class="md-text-field">
                        <input type="number" id="sessionAutoSaveFrequency" name="sessionAutoSaveFrequency" min="1"
                            max="1440" value="5" required>
                        <label for="sessionAutoSaveFrequency">Auto-Save Frequency (minutes)</label>
                    </div>
                    <p class="md-typescale-body-small field-description">
                        How often sessions are automatically backed up (1-1440 minutes).
                    </p>

                    <div class="md-checkbox">
                        <input type="checkbox" id="sessionAutoSaveEnabled" name="sessionAutoSaveEnabled">
                        <label for="sessionAutoSaveEnabled" class="md-typescale-body-medium">
                            Enable Auto-Save
                        </label>
                    </div>
                </div>

                <!-- Save Button -->
                <div class="form-actions">
                    <button type="submit" id="save-settings" class="md-button filled">Save Settings</button>
                    <div id="save-status" class="md-feedback"></div>
                </div>
            </div>

            <!-- Appearance Tab -->
            <div class="tab-content" id="tab-appearance">
                <!-- Color Themes Section -->
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Color Themes</h2>
                    <p class="md-typescale-body-medium section-description">
                        Choose your preferred color scheme. Changes are applied immediately.
                    </p>

                    <div class="theme-preview-container">
                        <!-- Light Themes -->
                        <div class="theme-preview" data-theme="gold">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Gold (Default)</span>
                        </div>



                        <div class="theme-preview" data-theme="platinum">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Platinum</span>
                        </div>

                        <div class="theme-preview" data-theme="emerald">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Emerald</span>
                        </div>

                        <div class="theme-preview" data-theme="sapphire">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Sapphire</span>
                        </div>

                        <div class="theme-preview" data-theme="ruby">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Ruby</span>
                        </div>

                        <div class="theme-preview" data-theme="amethyst">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Amethyst</span>
                        </div>

                        <div class="theme-preview" data-theme="copper">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Copper</span>
                        </div>

                        <div class="theme-preview" data-theme="obsidian">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Obsidian</span>
                        </div>

                        <div class="theme-preview" data-theme="steel">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Steel</span>
                        </div>

                        <div class="theme-preview" data-theme="midnight">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Midnight</span>
                        </div>

                        <!-- Dark Theme Variants -->
                        <div class="theme-preview" data-theme="gold-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Gold Dark</span>
                        </div>



                        <div class="theme-preview" data-theme="platinum-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Platinum Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="emerald-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Emerald Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="sapphire-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Sapphire Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="ruby-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Ruby Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="amethyst-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Amethyst Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="copper-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Copper Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="obsidian-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Obsidian Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="steel-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Steel Dark</span>
                        </div>

                        <div class="theme-preview" data-theme="midnight-dark">
                            <div class="theme-color-swatch">
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                                <div class="color-dot"></div>
                            </div>
                            <span class="theme-name">Midnight Dark</span>
                        </div>

                    </div>



                    <!-- Hidden select for form submission -->
                    <input type="hidden" id="theme" name="theme" value="gold">
                </div>

                <!-- Save Button -->
                <div class="form-actions">
                    <button type="submit" class="md-button filled">Save Settings</button>
                    <div id="save-status-appearance" class="md-feedback"></div>
                </div>
            </div>

            <!-- Sessions Tab -->
            <div class="tab-content" id="tab-sessions">
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Session Manager</h2>
                    <p class="md-typescale-body-medium section-description">
                        Save and restore your browser sessions including suspended tabs, window layouts, and tab groups.
                        Auto-save backs up your sessions at configurable intervals.
                    </p>



                    <!-- Session List Controls -->
                    <div class="session-list-controls">
                        <div class="session-list-header">
                            <h3 class="subsection-title">Saved Sessions</h3>
                            <div class="sessions-header-actions">
                                <button type="button" id="save-current-session" class="md-button text">
                                    Save Current Session
                                </button>
                                <button type="button" id="clear-all-sessions" class="md-button text danger">
                                    Clear All Sessions
                                </button>
                                <div class="session-sort-container">
                                    <label for="session-sort" class="sort-label">Sort by:</label>
                                    <select id="session-sort" class="md-select compact" aria-label="Sort sessions">
                                        <option value="newest">Newest First</option>
                                        <option value="oldest">Oldest First</option>
                                        <option value="name">By Name</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="session-status" class="md-feedback"></div>

                    <!-- Sessions List -->
                    <div class="sessions-container">
                        <div id="sessions-loading" class="sessions-loading">
                            <div class="loading-spinner"></div>
                            <span>Loading sessions...</span>
                        </div>

                        <div id="sessions-empty" class="sessions-empty hidden">
                            <div class="empty-icon">📁</div>
                            <h3 class="md-typescale-title-medium">No Sessions Saved</h3>
                            <p class="md-typescale-body-medium">
                                Save your first session to get started. Sessions include all windows, tabs, and their
                                state.
                            </p>
                        </div>

                        <div id="sessions-list" class="sessions-list">
                            <!-- Sessions will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tools Tab -->
            <div class="tab-content" id="tab-tools">
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">Tools & Data Management</h2>

                    <div class="tool-section">
                        <h3 class="md-typescale-title-medium subsection-title">Export/Import Suspended Tabs</h3>
                        <p class="md-typescale-body-medium section-description">
                            Backup and restore your suspended tabs data.
                        </p>

                        <div class="export-import-controls">
                            <div class="export-group">
                                <div class="md-text-field compact">
                                    <select id="export-format" aria-label="Export format">
                                        <option value="json">JSON</option>
                                        <option value="txt">TXT</option>
                                    </select>
                                    <label for="export-format">Export Format</label>
                                </div>
                                <button type="button" id="export-suspended-tabs" class="md-button outlined">
                                    Export
                                </button>
                            </div>

                            <div class="import-group">
                                <div class="file-input-container">
                                    <input type="file" id="import-file" accept=".json,.txt" class="file-input">
                                    <label for="import-file" class="file-input-label md-button outlined">
                                        Choose File
                                    </label>
                                </div>
                                <button type="button" id="import-suspended-tabs" class="md-button outlined">
                                    Import
                                </button>
                            </div>
                        </div>

                        <div id="export-import-status" class="md-feedback"></div>
                    </div>

                    <div class="md-divider"></div>

                    <div class="tool-section">
                        <h3 class="md-typescale-title-medium subsection-title">Keyboard Shortcuts</h3>
                        <p class="md-typescale-body-medium section-description">
                            Configure keyboard shortcuts for quick access to suspension actions.
                        </p>
                        <a href="shortcuts.html" class="md-button filled tool-link">
                            Configure Keyboard Shortcuts
                        </a>
                    </div>

                    <div class="md-divider"></div>

                    <div class="tool-section">
                        <h3 class="md-typescale-title-medium subsection-title">Migration</h3>
                        <p class="md-typescale-body-medium section-description">
                            Migrate your settings and suspended tabs from The Marvelous Suspender.
                        </p>
                        <a href="migrate.html" class="md-button filled tool-link">
                            Migrate from Marvelous Suspender
                        </a>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="tab-content" id="tab-about">
                <div class="md-card settings-section">
                    <h2 class="md-typescale-title-large section-title">About The One Suspender</h2>

                    <div class="about-section">
                        <h3 class="md-typescale-title-medium subsection-title">Version Information</h3>
                        <p class="md-typescale-body-large">
                            Version: <span id="extension-version" class="version-text">Loading...</span>
                        </p>
                        <p class="md-typescale-body-medium section-description">
                            You are using The One Suspender extension for Chrome.
                        </p>
                        <p class="md-typescale-body-medium section-description">
                            This extension helps manage browser memory by automatically suspending inactive tabs
                            while preserving their state for quick restoration.
                        </p>
                    </div>

                    <div class="md-divider"></div>

                    <div class="about-section">
                        <h3 class="md-typescale-title-medium subsection-title">Support & Information</h3>
                        <p class="md-typescale-body-medium section-description">
                            Get help and learn more about The One Suspender.
                        </p>

                        <div class="links-grid">
                            <a href="https://github.com/enderunal/TheOneSuspender/issues" target="_blank" rel="noopener"
                                class="md-button outlined">
                                Report an Issue
                            </a>
                            <a href="privacy.html" target="_blank" rel="noopener" class="md-button outlined">
                                Privacy Policy
                            </a>
                            <a href="license.html" target="_blank" rel="noopener" class="md-button outlined">
                                License
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <!-- Footer -->
        <footer class="options-footer">
            <p class="md-typescale-body-small">
                The One Suspender v<span id="footer-version">Loading...</span>
            </p>
        </footer>
    </div>

    <script src="src/ui/options.js" type="module"></script>
</body>

</html>